---
Лабораторный практикум:
 заголовок: 'Лабораторная работа 03.1: Создание приложений в Teams'
 модуль: 'Модуль 03: Создание приложения на холсте'
---

> [!ПРИМЕЧАНИЕ]
> С ноября 2020 г .:
>
> - Common Data Service переименована в Microsoft Dataverse. [Подробнее…](https://aka.ms/PAuAppBlog)
> - Обновлена некоторая терминология в Microsoft Dataverse. Например, *entity/объект* теперь *table/таблица*, а *field/поле* теперь *column/столбец*. [Подробнее…](https://go.microsoft.com/fwlink/?linkid=2147247)
>

Лабораторная работа 03.1: Создание приложений в Teams.
=================================

## Сценарий

Организации нередко накапливают неиспользуемые компьютерные периферийные устройства, шнуры питания и другую электронику. Ваша организация предпринимает шаги для повторного использования существующих устройств и компьютерной периферии перед заказом нового оборудования.

Вас просят создать приложение, в котором пользователи могут публиковать устройства, которые им больше не нужны, и просматривать то, что опубликовали их коллеги.

## Требования

1)	Приложение должно использовать Dataverse для команд.
2)	Пользователи должны иметь возможность создавать новые элементы, редактировать созданные ими элементы и видеть элементы, созданные другими пользователями.
3)	Элементы следует удалить из списка, если они больше не доступны.
4) Разрешить пользователям резервировать товар.
5) Разрешить пользователю отмечать предмет для получения.
6) Если элемент зарезервирован, только зарезервированный пользователь должен иметь возможность отмечать выбранный элемент.
7) Пользователи должны иметь возможность искать элементы.

## Что вы узнаете

1)	Как создать приложение с помощью Dataverse для команд.
2)	Как опубликовать приложение.
3)	Как дать другим пользователям разрешение на ваше приложение.

## Подробные шаги

### Упражнение 1. Начало работы с Microsoft Dataverse для Teams

В этом упражнении вы создадите новую команду и установите Power Apps для Teams.

#### Задача 1: Создание команды
В этом задании вы создадите новую команду

1. Перейдите в [Microsoft Teams](https://teams.microsoft.com).
2. Выберите **Команды**, нажмите **Присоединиться или создать команду** и нажмите **Создать команду**.

![Снимок экрана с рамкой вокруг кнопки команд в левой части окна и стрелкой, указывающей на кнопку создания команды](03-1/media/ex1-t1-image1.png)

3. Выберите **С нуля**.
4. Выберите **Публикация**.
5. Введите **Зеленый** в поле Имя команды и нажмите **Создать**.

![Скриншот со словом «Зеленый» в поле названия команды](03-1/media/ex1-t1-image2.png)

6. Щелкните **Пропустить**.
7. Теперь у вас должна быть новая команда **Зеленый**.

![Снимок экрана страницы Microsoft Teams с вашей новой командой, названной «Зеленый» в разделе ваших команд](03-1/media/ex1-t1-image3.png)

8. Не уходите с этой страницы.

#### Задача 2: Установка Power Apps
В этой задаче вы установите Power Apps для команд.

1. Щелкните **... Дополнительные добавленные приложения**, найдите приложения Power Apps и выберите **Power Apps**.

![Снимок экрана со стрелкой, указывающей на значок с многоточием для дополнительных добавленных приложений в левой части страницы и рамкой вокруг кнопки приложений Power Apps](03-1/media/ex1-t2-image1.png)

2. Щелкните **Добавить**.

3. Щелкните правой кнопкой мыши вкладку Power Apps и выберите **Закрепить**.

![Снимок экрана со стрелкой, указывающей на значок Power Apps и рамкой вокруг кнопки Закрепить](03-1/media/ex1-t2-image2.png)


### Упражнение 2: Создание приложения
В этом упражнении вы подготовите Dataverse для Teams, создав приложение, а также создадите таблицу Dataverse со столбцами.

#### Задача 1: Создание приложения
В этой задаче вы подготовите Dataverse для Teams, создав приложение.
1. Перейдите в [Microsoft Teams](https://teams.microsoft.com).

2. Выберите Power Apps и нажмите **Начать сейчас**.

![Скриншот домашней страницы Power Apps](03-1/media/ex2-t1-image1.png)

3. Выберите команду **«Зеленый»**, которую вы создали, и нажмите **Создать**.
4. Введите **Upcycle** в качестве имени приложения и нажмите **Сохранить**.
5. Не уходите с этой страницы.

#### Задача 2: Создание таблицы
В этой задаче вы создадите таблицу и столбцы.

1. Щелкните **С данными** и выберите **+ Создать новую таблицу**.

![Снимок экрана со стрелкой, указывающей на параметр с данными, и рамкой вокруг кнопки создания новой таблицы из выбора запроса источника данных](03-1/media/ex2-t2-image2.png)

2. Введите **Гаджет** в качестве имени таблицы и нажмите **Создать**.
3. Щелкните **+ Добавить столбец**.
4. Введите **Описание** в поле Имя, выберите **Текст** в поле Тип и щелкните, чтобы развернуть раздел **Дополнительные параметры**.

![Снимок экрана со стрелкой, указывающей на кнопку дополнительных параметров](03-1/media/ex2-t2-image3.png)

5. Измените **Макс. Длина** на **500** и нажмите **Создать**.
6. Снова нажмите **+ Добавить столбец**.
7. Введите **Доступность** в поле Имя, выберите **Выбор** в поле Тип, введите **Доступен** в качестве первого варианта и нажмите **+ Новый выбор**.

![Снимок экрана со стрелкой, указывающей на кнопку нового выбора](03-1/media/ex2-t2-image4.png)

8. Введите **Зарезервировано** для второго варианта и нажмите **+ Новый вариант**.
9. Введите **Подобрано** для третьего варианта и нажмите **Создать**.
10. Экран вашего стола должен выглядеть, как показано на рисунке ниже.
 ![Снимок экрана со стрелкой, указывающей на слово, сохраненное в правом углу окна](03-1/media/ex2-t2-image5.png)
11. Закройте редактор таблиц, нажав кнопку **Закрыть**.
12. Не уходите с этой страницы.


#### Задача 3: Добавление столбцов
В этой задаче вы добавите в таблицу новые столбцы.

1. Выберите вкладку **Главная** и нажмите **Подробнее**.

![Снимок экрана с рамкой вокруг кнопки «Домой» и стрелкой, указывающей на кнопку «Просмотреть больше» в окне последних приложений на домашней странице Power Apps](03-1/media/ex2-t3-image1.png)

2. Щелкните, чтобы открыть таблицу **Гаджет**.
3. Щелкните **+ Добавить столбец**.
4. Введите **Местоположение** для Отображаемого имени, выберите **Текст** для Типа данных, сделайте столбец **Обязательным** и нажмите **Готово**.

![Скриншот окна добавления столбца с соответствующим текстом в каждом поле](03-1/media/ex2-t3-image.png)

5. Щелкните **+ Добавить столбец**.
6. Введите **Фото** в поле Отображаемое имя, выберите **Изображение** в поле Тип данных, установите флажок **Основное изображение** и нажмите **Готово**.

![Скриншот окна добавления столбца с соответствующим текстом в каждом поле](03-1/media/ex2-t3-image3.png)

7. Щелкните **+ Добавить столбец**.
8. Введите **Зарезервировано** для Отображаемого имени, выберите **Поиск** для Типа данных, выберите **Пользователь** для Связанной таблицы и нажмите **Готово**.

![Скриншот окна добавления столбца с соответствующим текстом в каждом поле](03-1/media/ex2-t3-image4.png)

9. Выберите столбец **Доступность**.
10. Выберите **Доступно** в качестве значения по умолчанию и нажмите **Готово**.

![Снимок экрана с рамкой, выбранной в качестве параметра значения по умолчанию](03-1/media/ex2-t3-image5.png)

11. Нажмите кнопку **Сохранить таблицу** в правом нижнем углу экрана.
12. Не уходите с этой страницы.


#### Задача 4: Редактирование приложения
В этой задаче вы отредактируете приложение по фильтрам для доступных гаджетов и отредактируете форму.

1. Выберите вкладку **Главная** и щелкните, чтобы открыть созданное приложение **Upcycle**.
2. Выберите **Экран1**. Если на экране уже есть форма, перейдите к следующему шагу, в противном случае щелкните **С данными** и выберите таблицу **Гаджеты** в разделе **Текущая среда**. Это создаст элементы экрана, включая форму.
3. Убедитесь, что **ПравыйКонтейнер1** развернут, и выберите элемент управления **РедактированиеФормы1** в дереве.

![Снимок экрана с рамкой вокруг кнопки редактирования формы под экраном 1](03-1/media/ex2-t4-image1.png)

3. Перейдите на панель **Свойства** и нажмите **Изменение поля**.

![Снимок экрана со стрелкой, указывающей на кнопку редактирования полей](03-1/media/ex2-t4-image2.png)

4. Нажмите кнопку **+ Добавить поле**.
5. Выберите поля, которых нет в элементе управления Редактирование Формы, из списка ниже и нажмите **Добавить**.
 1. **Имя**
 2. **Описание**
 3. **Наличие**
 4. **Расположение**
 5. **Зарезервировано**
 6. **Фото**

![Скриншот окна добавления поля](03-1/media/ex2-t4-image3.png)

6. Удалите все лишние поля и закройте панель **Поля**. В вашей форме должны быть только столбцы **Имя, Описание, Доступность, Местоположение, Зарезервировано и Фото**.
7. Измените **Столбцы** для Привязки к столбцам на **1**.

![Снимок экрана с рамкой вокруг поля столбцов и значением 1 в самом поле](03-1/media/ex2-t4-image4.png)

8. Выберите **Фото** внутри холста и измените **Ширина** на **400**.

![Скриншот выбранной внутри холста фотографии и границы вокруг поля размера, которая в панели свойств была изменена на 400](03-1/media/ex2-t4-image5.png)

9. Разверните форму и выберите карту данных **Зарезервировано**.

![Снимок экрана с рамкой вокруг зарезервированной карты данных, выбранной в форме редактирования 1](03-1/media/ex2-t4-image5_1.png)

10. Перейдите на панель **Свойства**, выберите вкладку **Дополнительно** и нажмите **Разблокировать**.

![Снимок экрана со стрелкой, указывающей на значок замка на расширенной вкладке](03-1/media/ex2-t4-image5_2.png)

11. Найдите отображение и измените значение **DisplayMode** на **DisplayMode.View**.

![Снимок экрана с рамкой вокруг поля режима отображения](03-1/media/ex2-t4-image5_3.png)

12. Выберите **Обзор галереи**.
13. Выберите **Элементы** в строке формул и замените значение формулой ниже. Эта формула отфильтрует гаджеты, чтобы отобразить только доступные гаджеты.

 ```Filter(Gadgets, Availability <> 'Availability (Gadgets)'.'Picked up')```

![Данные фильтра - снимок экрана](03-1/media/ex2-t4-image6.png)

14. Выберите **изображение** внутри галереи.

![Снимок экрана со стрелкой, указывающей на изображение 1 внутри галереи](03-1/media/ex2-t4-image7.png)

15. Перейдите к строке формул и измените значение изображения на формулу ниже.

```ThisItem.Photo```

![Скриншот соответствующей команды, помещенной в строку формул](03-1/media/ex2-t4-image8.png)

16. Выберите вкладку **Данные**, нажмите кнопку **... Дополнительные действия** в таблице **Гаджеты** и выберите **Обновить**.

![Снимок экрана со стрелкой, указывающей на значок с многоточием для дополнительных действий и рамкой вокруг кнопки обновления](03-1/media/ex2-t4-image9.png)

17. Нажмите **Сохранить** и дождитесь сохранения приложения.
18. Щелкните **Предварительный просмотр**.
19. Нажмите **+ Новая запись**.

![Снимок экрана с рамкой вокруг кнопки новой записи](03-1/media/ex2-t4-image10.png)

20. Заполните форму и нажмите **Нажмите или нажмите, чтобы добавить изображение**.

![Снимок экрана со стрелкой, указывающей на касание или кнопку щелчка, чтобы добавить изображение](03-1/media/ex2-t4-image11.png)

21. Предоставьте свою фотографию или выберите ее из папки ресурсов лабораторных работ.
22. Нажмите **Сохранить**.

![Снимок экрана со стрелкой, указывающей на значок галочки для сохранения](03-1/media/ex2-t4-image12.png)

23. Добавьте еще несколько предметов.
24. Теперь ваше приложение должно выглядеть как на изображении ниже. Закройте превью.

![Снимок экрана работающего приложения со стрелкой, указывающей на крестик, чтобы закрыть предварительный просмотр](03-1/media/ex2-t4-image13.png)

25. Не уходите с этой страницы.


#### Задача 5: Обновление строки Dataverse
В этой задаче вы добавите кнопки, которые позволят пользователям зарезервировать и / или забрать элемент, вы также обновите строки в Dataverse на зарезервированные или забранные.

1. Выберите **Приложение** в древовидном представлении и установите значение **OnStart** в формулу ниже. Эта формула создаст переменную с именем CurrentUser и установит ее значение для первого пользователя, который войдет в систему с соответствующей электронной почтой.

```Set(CurrentUser, First(Filter(Users, 'Primary Email' = User().Email)))```

![Снимок экрана с рамкой вокруг приложения, выбранного на вкладке экранов слева, и другой рамкой вокруг строки формул с введенной соответствующей командой](03-1/media/ex2-t5-image1.png)

2. Выберите Приложение, выберите **многоточие** и выберите **Запуск при включении**.
3. Выберите **ПравыйКонтейнер**.

![Снимок экрана с рамкой вокруг выбранного элемента ПравыйКонтейнер1](03-1/media/ex2-t5-image2.png)

3. Нажмите кнопку вставки **+** и выберите **Кнопка**.

![Снимок экрана со стрелкой, указывающей на значок плюса, который нужно вставить, и рамкой вокруг параметра кнопки](03-1/media/ex2-t5-image3.png)

4. Выберите **Древовидное представление**, дважды щелкните только что добавленную кнопку и переименуйте ее в **Кнопка резервирования**.

![Снимок экрана с текстом «Кнопка резервирования», выделенным как новое имя для добавленной вами кнопки](03-1/media/ex2-t5-image4.png)

5. Установите для параметра **Текст** кнопки «Зарезервировать» значение **Зарезервировать**.
6. Переместите кнопку «Зарезервировать» и поместите ее рядом с изображением.

![Скриншот выбранной кнопки "Зарезервировать", которая была помещена рядом с изображением по правой стороне](03-1/media/ex2-t5-image5.png)

7. Задайте для параметра **DisplayMode** кнопки «Зарезервировать» формулу, приведенную ниже. Эта формула отключит кнопку, если выбранный элемент недоступен.

```If(BrowseGallery1.Selected.Availability = 'Availability (Gadgets)'.Available, DisplayMode.Edit, DisplayMode.Disabled)```

8. Установите значение **OnSelect** кнопки «Зарезервировать» в соответствии с приведенной ниже формулой. Эта формула обновит выбранную запись, установив зарезервированное значение по текущему пользователю, и значение доступности - зарезервировано.

```Patch(Gadgets, BrowseGallery1.Selected, {Availability: 'Availability (Gadgets)'.Reserved, 'Reserved by': CurrentUser})```

9. Установите значение **Visible** кнопки «Зарезервировать» по формуле, приведенной ниже. Эта формула скроет кнопку, если пользователь создает новую запись.

```If(EditForm1.Mode = FormMode.View, true, false)```

10. Снова выберите **ПравыйКонтейнер**.
11. Нажмите кнопку вставки **+** и снова выберите **Кнопка**.
12. Выберите **Древовидное представление**, дважды щелкните только что добавленную кнопку и переименуйте ее в **Подобрано**.

![Снимок экрана с текстом «Подобрано», выделенным в качестве нового имени для кнопки, которую вы добавили](03-1/media/ex2-t5-image6.png)

12. Установите для параметра **Текст** кнопки «Зарезервировать» значение **Подобрано**.
13. Отрегулируйте ширину и переместите кнопку подбора так, чтобы она находилась справа от кнопки резерва.

![Снимок экрана, показывающий, что кнопка "Подобрано" выбрана и перемещена вправо от кнопки "Зарезервировать"](03-1/media/ex2-t5-image7.png)

14. Задайте для параметра **DisplayMode** Кнопки "Подобрано" формулу, приведенную ниже. Эта формула отключит кнопку, если выбранный элемент зарезервирован, при этом зарезервирован пользователем не являющимся текущим.

 ```If(BrowseGallery1.Selected.Availability = 'Availability (Gadgets)'.Reserved And BrowseGallery1.Selected.'Reserved by'.'Primary Email' <> CurrentUser.'Primary Email', DisplayMode.Disabled, DisplayMode.Edit)```

15. Задайте для параметра **OnSelect** Кнопки "Подобрано" формулу, приведенную ниже. Эта формула обновит выбранную запись, установив значения резервирования по текущему пользователю и доступности для получения. Вторая формула выберет первый элемент галереи.

```Patch(Gadgets, BrowseGallery1.Selected, {Availability: 'Availability (Gadgets)'.'Picked up', 'Reserved by': CurrentUser});Select(BrowseGallery1,1)```

16. Задайте для параметра **Visible** Кнопки "Подобрано" значение приведенной ниже формулы. Эта формула скроет кнопку, если пользователь создает новую запись.

```If(EditForm1.Mode = FormMode.View, true, false)```

 17. Нажмите **Сохранить**, чтобы сохранить изменения.
 18. Не уходите с этой страницы.


#### Задача 6: Добавление поиска
В этой задаче вы добавите в свое приложение возможность поиска.

1. Выберите **ПравыйКонтейнер**.
2. Щелкните на **+** меню вставки и выберите **+ Значок добавления**.
3. Поместите значок над формой.

![Снимок экрана с выбранным значком плюса](03-1/media/ex2-t6-image1.png)

4. Выберите значок, перейдите в **Свойства** и выберите **Поиск** для значка.

![Снимок экрана с рамкой вокруг параметра поиска, выбранного в качестве значка](03-1/media/ex2-t6-image2.png)

5. Щелкните на **+** меню вставка и выберите **Текстовое поле**.
6. Выберите **Древовидное представление**.
7. Выделите только что добавленное текстовое поле и переименуйте его в **Поле поиска**.

![Снимок экрана со словами «Поле поиска», выделенными как новое имя для добавленного вами текстового поля](03-1/media/ex2-t6-image3.png)

8. Поместите поле поиска справа от значка.

![Снимок экрана окна поиска, расположенного справа от значка](03-1/media/ex2-t6-image4.png)

9. Выберите **Поле поиска** и установите значение **OnChange** в формулу ниже. Эта формула сбросит галерею.

```Reset(BrowseGallery1)```

10. Выберите **Просмотр галереи** и измените формулу **Позиции** на формулу ниже. Формула неполная, мы завершим ее на следующем шаге.

```Filter(Search(Gadgets, 'Search Box'.Value, ), Availability <> 'Availability (Gadgets)'.'Picked up')```

11. Поместите курсор после **'Поле поиска'.Значение** и введите имя. Вы должны увидеть предложение crxxx_name, выберите предлагаемый столбец.

![Скриншот с рамкой вокруг текста "crefe4_name"](03-1/media/ex2-t6-image5.png)

12. Добавьте запятую после только что выбранного столбца имени, введите **описание** и снова выберите предложенный столбец.

![Скриншот с рамкой вокруг текста "crfe4_description"](03-1/media/ex2-t6-image6.png)

13. Теперь ваша формула должна выглядеть, как на изображении ниже. Эта формула будет искать в столбцах имени и описания таблицы гаджетов все, что пользователь вводит в текстовое поле, и отфильтровывать выбранные элементы.

![Предлагаемый столбец описания - снимок экрана](03-1/media/ex2-t6-image7.png)

14. Выберите **Поле поиска**.
15. Перейдите к строке формул и удалите текст **Значение**.

![Снимок экрана с рамкой вокруг строки формул](03-1/media/ex2-t6-image8.png)

16. Нажмите **Сохранить**, чтобы сохранить изменения.

### Упражнение 3: Тестирование и публикация приложения
В этом упражнении вы протестируете, опубликуете и дадите коллегам разрешение на использование приложения.

#### Задача 1: Тест приложения
В этой задаче вы протестируете приложение.

1. Нажмите кнопку **Предварительный просмотр**.

![Снимок экрана со стрелкой, указывающей на кнопку предварительного просмотра](03-1/media/ex3-t1-image1.png)

2. Кнопки **Зарезервировать** и **Подобраны** должны быть видимыми и активными.
3. Найдите кабель. В галерее должны отображаться элементы, у которых есть текст **кабель** в столбце имени или описания.

![Снимок экрана со словом "кабель" в строке поиска и галереей, показывающей элементы, у которых есть текст "кабель" в названии или столбце описания в левой части окна](03-1/media/ex3-t1-image2.png)

4. Выберите один из элементов, значение столбца **Зарезервировано** должно быть пустым.
5. Нажмите кнопку **Зарезервировать**.

![Снимок экрана с рамкой вокруг поля «Зарезервировано» и стрелкой, указывающей на кнопку «Зарезервировать»](03-1/media/ex3-t1-image3.png)

6. Кнопка **Зарезервировать** должна стать недоступной, а в качестве значения **Зарезервировано** будет установлено ваше имя пользователя. Нажмите кнопку **Подобрано**.

![Снимок экрана с рамкой вокруг поля зарезервированного пользователем с вашим именем пользователя и другой рамкой вокруг теперь отключенной кнопки резервирования](03-1/media/ex3-t1-image4.png)

7. Элемент больше не должен отображаться в галерее, и должен быть выбран первый элемент галереи.
8. Закройте предварительный просмотр.
9. Не уходите с этой страницы.


#### Задача 2: Публикация приложения
В этой задаче вы опубликуете приложение в Teams.

1. Нажмите кнопку **Опубликовать в Teams**.

![Снимок экрана со стрелкой, указывающей на кнопку публикации для команд](03-1/media/ex3-t2-image1.png)

2. Щелкните **Далее**.
3. Щелкните **+** добавить приложение как вкладку.

![Снимок экрана со стрелкой, указывающей на значок плюса для добавления приложения в качестве вкладки в общем поле](03-1/media/ex3-t2-image2.png)

4. Нажмите **Сохранить и закрыть**.
5. Выберите **Команды** и перейдите на новую вкладку **Upcycle**.

![Снимок экрана со стрелкой, указывающей на кнопку «Upcycle»](03-1/media/ex3-t2-image3.png)

6. Приложение должно загрузиться. Если приложение не загружено, обновите страницу.

![Скриншот загруженного приложения](03-1/media/ex3-t2-image4.png)

7. Протестируйте приложение в Teams и убедитесь, что оно ведет себя так, как вы ожидали.


#### Задача 3: Предоставление разрешения
В этой задаче вы дадите своим коллегам разрешение на создание новых элементов, редактирование элементов, которые они создали, удаление элементов, которые они создали, и чтение элементов, созданных другими людьми.

1. Выберите **Power Apps** и щелкните ссылку **Подробнее**.

![Снимок экрана с рамкой вокруг кнопки «Power Apps» в левой части окна и стрелкой, указывающей на ссылку «Подробнее» в последних приложениях](03-1/media/ex3-t3-image1.png)

2. Щелкните, чтобы открыть таблицу **Гаджет**.
3. Щелкните **Управление разрешениями**.

![Снимок экрана со стрелкой, указывающей на кнопку управления разрешениями](03-1/media/ex3-t3-image2.png)

4. Выберите **Участники**, выберите разрешение **Совместная работа** и нажмите **Сохранить**.

![Скриншот выбранного разрешения на совместную работу](03-1/media/ex3-t3-image3.png)

5. Вы можете протестировать приложение с другим пользователем и посмотреть, как оно себя ведет.

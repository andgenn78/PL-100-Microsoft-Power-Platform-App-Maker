---
Лабораторный практикум:
 заголовок: 'Лабораторная работа 05: Power BI'
 модуль: 'Модуль 05: Power BI'
---

> [!ПРИМЕЧАНИЕ]
> С ноября 2020 г .:
> - Common Data Service переименована в Microsoft Dataverse. [Подробнее…](https://aka.ms/PAuAppBlog)
> - Обновлена некоторая терминология в Microsoft Dataverse. Например, *entity/объект* теперь *table/таблица*, а *field/поле* теперь *column/столбец*. [Подробнее…](https://go.microsoft.com/fwlink/?linkid=2147247)
>


# Лабораторная работа 05: Power BI

В этой лабораторной работе вы создадите панель мониторинга Power BI, которая визуализирует данные о проблемах, о которых сообщили сотрудники компании.

## Что вы узнаете

 - Как подключиться к Dataverse 
 - Как уточнить модель данных и подготовить ее к отчетности
 - Как создать визуализацию Power BI 
 - Как встроить отчет Power BI в Microsoft Teams.

## Лабораторные этапы высокого уровня

Мы выполним следующие шаги, чтобы спроектировать и создать панель мониторинга Power BI:

- Подключение к таблицам в Microsoft Dataverse 
- Преобразование данных для включения удобного для пользователя описания связанных строк (поисковых запросов).
- Создание и публикация отчета с различной визуализацией информации отчетов о проблемах
- Пользовательский запрос на естественном языке для создания дополнительных визуализаций
- Создание мобильного вида
- Встраивание отчета Power BI Компании 311 в Microsoft Teams.

## Предварительные требования

* Должно быть выполнено **Лабораторная работа 02.1: Модель данных и приложение на основе модели**
* Разрешения на установку программ на ваш компьютер (требуется для установки Power BI Desktop)

## Что следует учесть перед началом

- Кто является целевой аудиторией отчета?
- Как аудитория воспримет отчет? Типовое устройство? Место нахождения?
- У вас достаточно данных для визуализации?
- Какие возможные характеристики вы можете использовать для анализа данных о посещениях?

## Подробные шаги

### Упражнение 1. Подготовка среды и данных 

**Цель:** В этом упражнении вы установите и настроите Power BI Desktop и настроите подключение к Microsoft Dataverse. 

> [!ВАЖНО]
> Если у вас нет необходимых разрешений для установки настольных приложений или возникают трудности с настройкой Power BI Desktop и подключением его к данным, выполните **Дополнение: Импорт образцов данных**, а затем продолжите **Упражнение 2**, но с использованием Power BI service вместо Power BI Desktop.

#### Задача 1. Настройка Power BI Desktop

1. Если у вас не установлен Power BI Desktop, перейдите по адресу [https://aka.ms/pbidesktopstore](https://aka.ms/pbidesktopstore), чтобы загрузить и установить приложение Power BI.

> [!ВАЖНО]
> Если у вас возникли проблемы с установкой Power BI Desktop с помощью Microsoft Store, попробуйте автономный установщик, который можно загрузить с [https://aka.ms/pbiSingleInstaller](https://aka.ms/pbiSingleInstaller).

2. Откройте Power BI Desktop.
2. Если вы ранее входили в Power BI Desktop, выберите **Файл | Выход**
3. Войдите в систему, если будет предложено, или выберите **Файл | Вход**, чтобы войти.
4. Если вы входите в систему впервые, вы можете получить следующее сообщение

![Снимок экрана с предложением зарегистрировать учетную запись Power BI, если это ваш первый опыт](05/media/image-6-2.png)

5. Выберите **Зарегистрироваться в Power BI** и следуйте инструкциям, чтобы завершить регистрацию. 

#### Задача 2: Подготовка данных

1. Узнайте URL-адрес вашей организации.

 * Перейдите в [Центр администрирования Power Platform](https://aka.ms/ppac).
 * На левой странице навигации выберите Среды, а затем щелкните целевую среду.
 * Щелкните правой кнопкой мыши **URL-адрес среды** на панели **Подробности**, затем выберите **Копировать ссылку**.

![Снимок экрана со стрелкой, указывающей на URL-адрес среды, и другой стрелкой, указывающей на кнопку копирования ссылки](05/media/image-6-1.png)

2. Переключитесь на рабочий стол Power BI.
3. Выберите **Получить данные | Более...**

![Снимок экрана со стрелкой, указывающей на кнопку получения данных, и другой стрелкой, указывающей на кнопку «Дополнительно» в нижней части раскрывающегося списка получения данных](05/media/image-6-3.png)

4. Выберите **Power Platform**, затем выберите **Dataverse** и нажмите **Подключиться**.

![Снимок экрана с инверсией данных, выбранной в окне Power Platform](05/media/image-6-4.png)

5. Вставьте скопированный ранее URL-адрес среды без https: //, выберите **DirectQuery** и нажмите **ОК**.

![Снимок экрана с URL-адресом среды, вставленным в поле домена среды](05/media/image-6-5.png)

6. Откроется диалоговое окно с подробностями подключения. Если вы не вошли в систему, нажмите **Войти** и следуйте инструкциям по входу. Нажмите **Подключиться**.

7. Разверните узел среды, выберите таблицы **lh_Building**, **lh_Department**, **lh_ProblemReport** и выберите **Загрузить**. Дождитесь завершения загрузки.

![Снимок экрана со стрелкой, указывающей на кнопку загрузки](05/media/image-6-7.png)

8. Щелкните значок **Модель** на левой вертикальной панели инструментов.

![Снимок экрана со стрелкой, указывающей на значок модели на левой вертикальной панели инструментов](05/media/image-6-8.png)

9. Power BI должен определить взаимосвязь между таблицей. Отношения должны выглядеть, как на изображении ниже.

![Скриншот отношения между таблицами. Должно быть три основных панели: Ih_building, Ih_problemreport и Ih_department](05/media/image-6-9.png)

10. Выберите значок **Отчет** на левой панели инструментов.

![Снимок экрана со стрелкой, указывающей на значок отчета на левой панели инструментов](05/media/image-6-10.png)

11. Разверните узел **lh_ProblemReports** на панели **Поля**.

12. Нажмите кнопку **...** Дополнительные параметры в таблице **lh_ProblemReports**.

![Снимок экрана со стрелкой, указывающей на многоточие, показывающее дополнительные параметры](05/media/image-6-11.png)

13. Выберите **Новый столбец**.

![Снимок экрана с рамкой вокруг кнопки нового столбца](05/media/image-6-12.png)

14. Заполните формулу, как показано ниже, и нажмите ENTER или нажмите кнопку с галочкой. Это добавит новый столбец с названием здания в данные отчета о проблеме.

```Building = RELATED(lh_Building[lh_name])```

![Снимок экрана со стрелкой, указывающей на значок галочки](05/media/image-6-13.png)

15. Повторите три предыдущих шага на узле **lh_problemreports**, чтобы добавить столбец **Отдел** с приведенной ниже формулой.

```Department = RELATED(lh_Department[lh_name])```

16. Щелкните ... Далее в столбце **lh_problemreportid** таблицы **lh_problemreport** и выберите **Переименовать**. Введите **Отчет о проблеме** в качестве имени столбца.
17. Щелкните ... Далее в столбце **statuscodename** и выберите **Переименовать**. Введите **Статус** в качестве имени столбца.
18. Сохраните незавершенную работу, нажав **Файл &#124; Сохранить** и введите **Управление проблемами** в качестве имени файла.

### Упражнение 2: Создание отчета Power BI 

**Цель:** В этом упражнении вы создадите отчет Power BI на основе данных из таблиц Microsoft Dataverse.

#### Задача 1. Создание диаграмм и визуализаций времени

1. Щелкните значок **Круговая диаграмма** на панели **Визуализации**, чтобы вставить диаграмму.

![Снимок экрана со стрелкой, указывающей на значок круговой диаграммы](05/media/image-6-14.png)

2. Перетащите столбец **Здание** в поле назначения **Легенда**.
3. Перетащите столбец **Отчет о проблеме** в целевое поле **Значения**.

![Снимок экрана со стрелкой, указывающей направление, в котором отчет о проблеме необходимо перетащить из столбца полей в поле значений](05/media/image-6-15.png)

4. Измените размер круговой диаграммы с помощью угловых маркеров, чтобы были видны все компоненты диаграммы. Теперь ваш отчет должен выглядеть так:

![Снимок экрана с рамкой вокруг легенды рядом с круговой диаграммой после изменения размера, чтобы все ваши компоненты были видны](05/media/image-6-16.png)

5. Щелкните **Новый визуальный элемент** на ленте Power BI, затем выберите **диаграмму с накоплением столбцов** на панели **Визуализации**. 

![Снимок экрана со стрелкой, указывающей на значок столбчатой диаграммы с накоплением](05/media/image-6-17.png)

6. Перетащите столбец **Отчет о проблеме** в поле **Значения**.
7. Перетащите столбец **Состояние** в целевое поле **Ось**.
8. Измените размер диаграммы, используя угловые ручки.
9. Протестируйте интерактивность отчета:

 * Выбирайте различные фрагменты зданий на круговой диаграмме и наблюдайте за изменениями на столбчатой диаграмме с накоплением.
 * Выберите различные столбцы на столбчатой диаграмме с накоплением и наблюдайте за изменениями в круговом отчете.

![Снимок экрана со стрелкой, указывающей на круговую диаграмму, для наблюдения за измененными данными после изменения данных на столбчатой диаграмме с накоплением](05/media/image-6-18.png)

10. Выберите **Вставить** и нажмите **Вопросы и ответы**.

![Снимок экрана со стрелкой, указывающей на кнопку вопросов и ответов](05/media/image-6-addbutton.png)

11. Выберите **Включить вопросы и ответы** и дождитесь подготовки вопросов и ответов.
12. Введите **столбчатое количество отчетов о проблемах при построении** и нажмите Enter. Вы должны увидеть гистограмму.

![Снимок экрана с соответствующим текстом, введенным в поле вопросов и ответов](05/media/image-6-QAchart.png)

13. На панели управления теперь включены вопросы и ответы. Нажмите кнопку **...** Дополнительные параметры визуального элемента «Вопросы и ответы» и нажмите **Удалить**.

![Снимок экрана со стрелкой, указывающей на значок с многоточием для дополнительных параметров и рамкой вокруг кнопки удаления](05/media/image-6-removevisual.png)

14. Сохраните незавершенную работу, выбрав **Файл | Сохранить**.


### Упражнение 3. Создание панели мониторинга Power BI

#### Задача 1. Публикация отчета Power BI

1. Перейдите в [Службу Power BI](https://app.powerbi.com).
2. Выберите **Рабочие области** и нажмите **Создать рабочее пространство**.

![Снимок экрана с рамкой вокруг кнопки рабочего пространства и стрелкой, указывающей на кнопку создания рабочего пространства](05/media/image-6-createworkspace.png)

3. Введите **Рабочее пространство 311** в поле Имя рабочего пространства и нажмите **Сохранить**.
4. Вернитесь в классическое приложение Power BI, выберите вкладку **Главная** и нажмите **Опубликовать**.

![Снимок экрана со стрелкой, указывающей на кнопку публикации](05/media/image-6-19.png)

5. Выберите ** Рабочее пространство 311** в качестве места назначения, затем нажмите **Выбрать**.

6. Дождитесь завершения публикации и щелкните **Открыть\<имя вашего отчета\>.pbix в Power BI**.

![Снимок экрана со стрелкой, указывающей на кнопку открытия отчета](05/media/image-6-20.png)

В браузере откроется опубликованный отчет.

> [!ПРИМЕЧАНИЕ]
> Если вы получаете сообщение об ошибке в службе Power BI Service с сообщением «в источнике данных отсутствуют учетные данные и к нему невозможно получить доступ», выполните следующие действия:
>
> 1. Выберите Рабочее пространство 311 и выберите набор данных управления проблемами.
> 2. Разверните раскрывающийся список «Обновление» и выберите «Расписание обновления».
> 3. Разверните раздел «Учетные данные источника данных» и выберите «Редактировать учетные данные».
> 4. Выберите OAuth2 в качестве метода аутентификации и организационного метода для настройки уровня конфиденциальности.
> 5. Выберите Войти. Это решит проблему для отчета, и он должен правильно отображаться в службе Power BI.

#### Задача 2. Создание панели мониторинга Power BI

1. Разверните **Рабочее пространство 311**.
2. Выберите отчет **Управление проблемами** под заголовком **Отчеты**.

![Снимок экрана с рамкой вокруг параметра управления проблемами под отчетами](05/media/image-6-21.png)

3. Выберите **Закрепить на панели управления** в меню. В зависимости от макета вам может потребоваться нажать **...**, чтобы отобразить дополнительные пункты меню.

![Снимок экрана со стрелкой, указывающей на значок с многоточием для дополнительных параметров, и рамкой вокруг параметра закрепления на панели управления](05/media/image-6-22.png)

4. Выберите **Новая панель мониторинга** в строке **Закрепить на панели мониторинга**.
5. Введите **Панель управления проблемами** в качестве **Имя информационной панели**, выберите **Pin live**.

![Снимок экрана с выводом на панель мониторинга и измененным именем панели](05/media/image-6-23.png)

6. Выберите узел **Рабочее пространство 311**, выберите **Панель управления проблемами**.
7. Протестируйте интерактивность отображаемых круговых диаграмм и гистограмм.

#### Задача 3. Добавление визуализаций с использованием естественного языка

1. Выберите **Задайте вопрос о ваших данных** в верхней части панели управления.

![Снимок экрана со стрелкой, указывающей на кнопку «Задать вопрос о ваших данных» в верхней части панели инструментов](05/media/image-6-24.png)

2. Введите **количество воронок отчетов о проблемах по статусу** в области вопросов и ответов. Отобразится воронкообразная диаграмма.
3. Выберите **Закрепить визуально**.

![Снимок экрана со стрелкой, указывающей на визуальную кнопку закрепления](05/media/image-6-25.png)

4. Выберите **Существующая панель мониторинга**, выберите **Панель управления проблемами**, выберите **Закрепить**.

#### Задача 4. Создание представления для мобильного устройства

1. Выберите **Панель управления проблемами** в области **Панели мониторинга**.
2. Нажмите **Изменить**, а затем выберите **Мобильное представление** в раскрывающемся списке.
3. Переставьте плитки по своему желанию.

![Фотография макета мобильного телефона с перестановкой плиток для отображения данных](05/media/image-6-26.png)

4. Выберите свой отчет в разделе **Рабочая область 311 | Отчеты**
5. Выберите **Файл**, а затем выберите **Создать QR-код** из раскрывающегося списка.

![Снимок экрана со стрелкой, указывающей на кнопку файла и рамкой вокруг кнопки создания QR-кода](05/media/image-6-27.png)

6. Если у вас есть мобильное устройство, отсканируйте код с помощью приложения для сканирования QR-кодов, доступного на платформах iOS и Android.

> [!ПРИМЕЧАНИЕ]
> Для доступа к панели управления и отчета вам необходимо войти в систему на телефоне как тот же пользователь.

7. Перемещайтесь и исследуйте отчеты и информационные панели на мобильном устройстве. 

### Упражнение 4. Встраивание отчета Power BI

В этом упражнении вы добавите отчет Power BI Компании 311 в Microsoft Teams и в приложение на основе модели Администратор Компании 311, чтобы руководство и персонал могли просматривать отчеты непосредственно из Microsoft Teams и приложения на основе модели. 

#### Задача 1: Настройка команды Компании 311

В этой задаче вы настроите команду Microsoft Teams для компании Lamna Healthcare, если вы не сделали этого ранее.

1. Перейдите к [Microsoft Teams](https://teams.microsoft.com) и войдите в систему с учетными данными, которые вы использовали ранее.

2. Выберите **Использовать веб-приложение вместо** на экране приветствия.

![Снимок экрана целевой страницы Microsoft Teams и рамка вокруг кнопки использования веб-приложения вместо](05/media/image-6-teams.png)

3. Когда откроется окно Microsoft Teams, закройте приветственные сообщения.

4. В нижнем левом углу выберите **Присоединиться или создать команду**.

5. Выберите **Создать команду**.

![Снимок экрана с рамкой вокруг кнопки присоединения или создания группы в нижней части окна и другой рамкой вокруг кнопки создания группы](05/media/image-6-createteam.png)

6. Нажмите **С нуля**.

7. Выберите **Публикация**.

8. В качестве названия команды выберите **Компания 311** и выберите **Создать**.

9. Выберите **Пропустить** добавление участников в компанию 311.


#### Задача 2: встраивание отчета Power BI в Teams

1. Перейдите в [Microsoft Teams](https://teams.microsoft.com).

2. Выберите **Общий** канал команды **Компания 311**.

3. В верхней части страницы нажмите символ **+**, чтобы добавить новую вкладку.

![Скриншот общего канала команды компании 311](05/media/image-6-addpowerbitab.png)

4. Найдите **power** и выберите **Power BI** из результатов.

5. Разверните **Рабочее пространство 311**, выберите отчет, созданный ранее в этой лабораторной работе, и нажмите **Сохранить**.

![Снимок экрана с запросом, который появляется при выборе Power BI](05/media/image-6-choosepowerbireport.png)

6. Теперь вы должны увидеть свой отчет Power BI на вкладке в Microsoft Teams.

![Снимок экрана вашего отчета Power BI на вкладке в Microsoft Teams](05/media/image-6-powerbi.png)


#### Задача 3. Встраивание отчета Power BI в приложение на основе модели

1. Перейдите в [Power BI](https://app.powerbi.com/home).
2. Щелкните, чтобы выбрать **Наборы данных**.

![Снимок экрана с рамкой вокруг кнопки наборов данных](05/media/image-6-datasets.png)

3. Наведите указатель мыши на созданный набор данных, нажмите кнопку **...** Дополнительные параметры и выберите **Настройки**.

![Снимок экрана со стрелкой, указывающей на кнопку с многоточием, для дополнительных параметров и рамкой вокруг кнопки настроек](05/media/image-6-datasetsettings.png)

4. Щелкните **Изменить учетные данные** в разделе «Учетные данные источника данных».
5. Выберите **OAuth2** в качестве метода проверки подлинности, выберите **Организационный** для настройки уровня конфиденциальности и нажмите **Войти**.

![Снимок экрана окна редактирования учетных данных со всем соответствующим текстом в каждом поле](05/media/image-6-datasetconfiguration.png)

6. Укажите свои учетные данные.
7. Перейдите на [портал разработчиков Power Apps](https://make.powerapps.com/) и убедитесь, что вы находитесь в своей практической среде.
8. Выберите **Решения** и щелкните, чтобы открыть решение **Компания 311**.
9. Щелкните **+ Новое** и выберите **Информационная панель | Встроенный Power BI**.

![Снимок экрана со стрелкой, указывающей на новую кнопку, выбранной приборной панелью и рамкой вокруг встроенного параметра Power Bi](05/media/image-6-newpowerbiembeddeddash.png)

10. Введите **Управление проблемами** для Отображаемого имени, выберите **Отчет Power BI** для типа, выберите **Рабочее пространство 311** для рабочего пространства Power BI, выберите **Управление проблемами** для отчета Power BI и нажмите **Сохранить**.

![Снимок экрана нового окна встроенных данных Power BI со всем соответствующим текстом в каждом поле](05/media/image-6-powerbidashprop.png)

11. Щелкните **Опубликовать все настройки** и дождитесь завершения публикации.
12. Находясь в решении «Компания 311», щелкните, чтобы открыть приложение **Администратор компании 311** на основе модели.

![Снимок экрана со стрелкой, указывающей на параметр администратора компании 311 с другой рамкой вокруг приложения на основе модели в столбце типа в соответствии с правильным параметром администратора компании 311](05/media/image-6-editmodeldrivenapp.png)

13. Щелкните значок **Изменить** в файле Sitemap.

![Снимок экрана со стрелкой, указывающей на значок карандаша для редактирования карты сайта](05/media/image-6-editsitemap.png)

14. Нажмите **+ Добавить** и выберите **Группа**.

![Снимок экрана со стрелкой, указывающей на кнопку добавления и рамкой вокруг кнопки группы](05/media/image-6-eddgroup.png)

16. Перейдите на панель **Свойства** и введите **Отчеты** в качестве заголовка.
17. Выберите группу **Отчеты**, которую вы только что создали, нажмите **+ Добавить** и выберите **Подрайон**.

![Снимок экрана со стрелкой, указывающей на кнопку добавления и рамкой вокруг кнопки подобласти](05/media/image-6-eddsubarea.png)

18. Перейдите на панель **Свойства**, выберите **Информационная панель** для Типа, выберите **Управление проблемами** для Информационной панели по умолчанию и введите **Отчет о проблемах** для Заголовка.

![Скриншот окна подобласти с соответствующей опцией, выбранной в каждом поле](05/media/image-6-subareaprop.png)

19. Перетащите новую группу **Отчеты** перед группой **Проблемы**.
20. Группы в области **Управление проблемами** теперь должны выглядеть, как показано на рисунке ниже.

![Скриншот области управления проблемами, где отчеты и проблемы являются двумя элементами в этой области](05/media/image-6-areagroups.png)

21. Нажмите **Сохранить и закрыть**, чтобы закрыть редактор карты сайта.
22. Еще раз нажмите **Сохранить и закрыть**, чтобы закрыть конструктор приложения.
23. Нажмите **Готово**.
24. Щелкните **Опубликовать все настройки** и дождитесь завершения публикации.
25. Выберите **Приложения** и щелкните, чтобы запустить приложение **Администратор компании 311** на основе модели.
26. Отчет должен загрузиться.

![Скриншот вашего отчета об управлении проблемами](05/media/image-6-PowerBIinModel.png)

27. Взаимодействуйте с отчетом и убедитесь, что он ведет себя должным образом.

### Упражнение 5. Встроенный холст Power BI

В этом упражнении вы добавите встроенное приложение холста в Power BI в качестве визуального элемента.


#### Задача 1: Добавить холст

1. Перейдите в [Power BI](https://app.powerbi.com).
2. Выберите **Рабочие области**, а затем откройте **Рабочее пространство 311**.
3. Щелкните, чтобы открыть отчет **Управление проблемами**.
4. Щелкните **Изменить**.
5. Измените размер и положение визуальных элементов, как показано ниже.

![Визуальные элементы Power BI - снимок экрана](05/media/image-6-PowerBIVisuals.png)

6. Щелкните пустую область холста, перейдите к **Визуализации** и щелкните **Power Apps для Power BI**.

![Power Apps для Power BI - снимок экрана](05/media/image-6-powerappsforpowerbi.png)

7. Выберите только что созданный визуальный элемент Power BI, разверните таблицу **lh_problemreport** и выберите столбец **Отчет о проблеме**.

![Столбец таблицы - снимок экрана](05/media/image-6-tablecolumn.png)

8. Выберите среду для практики и нажмите **Создать новую**.

![создать приложение - снимок экрана](05/media/image-6-createembeddedapp.png)

9. Должно открыться новое окно или вкладка браузера и загрузить студию приложений.
10. Не уходите с этой страницы.

#### Задача 2: настроить приложение

1. Щелкните правой кнопкой мыши **Галерея** и выберите **Удалить**.

![Кнопка удаления галереи - снимок экрана](05/media/ex_5_deletegallery.png)

2. Щелкните **Файл**.
4. Выберите **Настройки**.
5. Выберите **Дисплей**.
6. Измените **Ориентацию** на **Пейзаж**.
7. Нажмите **Применить** во всплывающем окне.
8. Закройте окно **Настройки**.
9. Выберите **Данные** и нажмите **Добавить данные**.

![Добавить данные - снимок экрана](05/media/ex_5_adddata.png)

10. Выберите таблицу **Отчеты о проблемах**.

![Выбрать таблицу данных - снимок экрана](05/media/ex_5_datatable.png)

11. Выберите объект **Приложение** в древовидном представлении.
12. Выберите **OnStart** объекта **Приложение** и задайте для него формулу ниже. Эта формула создаст две переменные: одну для отслеживания текущего индекса таблицы отчетов, а другую - для отслеживания текущей строки элемента.

```Set(currentIndex,1);Set(CurrentItem, LookUp('Problem Reports', 'Problem Report' = GUID(Last(FirstN([@PowerBIIntegration].Data,currentIndex)).'Problem Report')))```

![Снимок экрана, на котором для свойства OnStart установлено выражение, описанное на предыдущем шаге](05/media/ex_5_apponstart.png)

13. Выберите вкладку **Вставка**, щелкните **Медиа** и выберите **Изображение**.

![Скриншот вставки](05/media/ex_5_insertimage.png)

14 Задайте для параметра **Изображение** формулу, приведенную ниже.

```CurrentItem.Photo```

15. Нажмите кнопку **...** объекта **Приложение** и выберите **Запуск при включении**.

![Запуск приложения OnStart - снимок экрана](05/media/ex_5_runonstart.png)

16. Вы должны увидеть фото. Если вы не видите фотографию, перейдите в приложение на основе модели и добавьте фотографию в записи отчетов о проблемах.

![Текущее изображение с фото - скриншот](05/media/ex_7_imagephoto.png)

17. Установите значение **X** изображения на **0**.
18. Установите значение **Y** изображения на **0**.
19. Установите значение **Ширина** изображения по формуле ниже.

```Parent.Width```

20. Установите значение **Высота** изображения по формуле ниже.

```Parent. Height```

21. Изображение должно заполнить экран.

![Положение изображения - снимок экрана](05/media/ex_7_imageposition.png)

22. Не уходите с этой страницы.


#### Задача 3: Добавление элементов управления

1. Выберите вкладку **Вставка** и нажмите **Ярлык**.
2. Выберите только что добавленную метку и установите значение **Текст** в формулу ниже.

```CurrentItem.Title```

3. Установите значение **Высота** метки на **60**.
4. Установите значение **X** метки на **0**.
5. Установите значение **Y** метки в формулу ниже.

```Parent.Height -Self.Height```

6. Задайте для значения **Ширина** метки формулу, приведенную ниже.

```Parent.Width```

7. Установите значение **Заливка** метки на **RGBA (0, 108, 191, .5)**.
8. Установите значение **Цвет** метки на **RGBA (255, 255, 255, 1)**.
9. Установите значение **Выравнивание** в формулу ниже.

```Align.Center```

10. Теперь метка должна выглядеть как на изображении ниже. Если вы не видите заголовок, нажмите кнопку **...** объекта **Приложение** и **Запуск при включении** снова.

![Размер ярлыка - снимок экрана](05/media/ex_7_resizedlabel.png)

11. Перейдите на вкладку **Вставка**, щелкните **Значки** и выберите **Далее**.
12. Дважды щелкните только что добавленный значок и переименуйте его в **Значок Далее**.
13. Перейдите на вкладку **Вставка**, щелкните **Значки** и выберите **Назад**.
14. Дважды щелкните второй значок, который вы только что добавили, и переименуйте его в **Значок Назад**.
15. Перетащите значок **Далее** над правой стороной метки.
16. Перетащите значок **Назад** над левой стороной метки.
17. Значки теперь должны выглядеть, как на изображении ниже.

![Расположение значка - снимок экрана](05/media/ex_7_iconlocation.png)

18. Щелкните значок **Далее** и установите значение **OnSelect** на формулу ниже.

```UpdateContext({CurrentItem: LookUp('Problem Reports', 'Problem Report' = GUID(Last(FirstN([@PowerBIIntegration].Data,currentIndex)).'Problem Report'))});UpdateContext({currentIndex: currentIndex +1})```

19. Задайте для **DisplayMode** значка **Далее** формулу, приведенную ниже.

```If(currentIndex = CountRows([@PowerBIIntegration].Data), DisplayMode.Disabled, DisplayMode.Edit)```

20. Выберите значок **Назад** и установите значение **OnSelect** на формулу ниже.

```UpdateContext({CurrentItem: LookUp('Problem Reports', 'Problem Report' = GUID(Last(FirstN([@PowerBIIntegration].Data,currentIndex)).'Problem Report'))});UpdateContext({currentIndex: currentIndex -1})```

21. Задайте для **DisplayMode** значка **Назад** формулу, приведенную ниже.

```If(currentIndex > 1, DisplayMode.Edit, DisplayMode.Disabled)```

22. Перейдите на вкладку **Вставка**, щелкните **Значки** и выберите **Проверить**.
23. Переименуйте значок проверки в **Значок завершения**.
24. Переместите **значок завершения** в верхний правый угол экрана.
25. Установите для параметра OnSelect **значка проверки** формулу ниже. Эта формула обновит статус строки до завершенного, а затем обновит Power BI.

```Patch('Problem Reports', CurrentItem, {'Status Reason': 'Status Reason (Problem Reports)'.Completed}); PowerBIIntegration.Refresh()```

26. Щелкните **Запуск**.
27. Щелкните значки «Далее» и «Назад» и убедитесь, что изображение изменилось.
28. Закройте превью.

29. Щелкните **Файл**.
30. Нажмите **Сохранить**.
31. Выберите **Облако** введите **Приложение для встраивания Power BI**.
32. Нажмите **Сохранить**.
33. Закройте окно или вкладку браузера студии приложения.
34. Теперь вы должны вернуться к отчету Power BI. Нажмите **Обновить** в верхнем заголовке.
35. Щелкните значки **Далее** и **Назад**, чтобы убедиться, что приложение загружает изображения.

 ![Холст внутри отчета Power BI - снимок экрана](05/media/ex_7_canvasembedded.png)

36. Выберите столбец **Завершено** столбчатой диаграммы с накоплением и отметьте, сколько строк заполнено.
37. Выберите любой столбец столбчатой диаграммы с накоплением, кроме **Завершено**. Щелкните следующий значок, чтобы увидеть следующее изображение.
38. Щелкните значок **Завершить**. 

 ![Полный статус проблемы - снимок экрана](05/media/ex_7_complete.png)

39. Завершенный счет должен увеличиться. Если количество выполненных работ не увеличивается, нажмите «Обновить» и дождитесь обновления визуальных элементов.

 ![Увеличение количества завершенных - скриншот](05/media/ex_7_increasedcount.png)

40. Нажмите **Сохранить**, чтобы сохранить отчет.



## Испытания

* Панели мониторинга и отчеты, включающие детализацию отдельных отчетов с фотографиями.
* Отчет и анализ проблемных моделей и тенденций
* Визуализация статуса решения проблемы в виде воронки

## Дополнение

### Импорт образцов данных

В этом упражнении вы импортируете образцы данных в службу Power BI. Это позволит выполнить лабораторные упражнения, даже если у вас нет необходимых разрешений для установки настольных приложений или возникают трудности с настройкой Power BI Desktop и подключением его к данным. После завершения этого упражнения вы можете пропустить **Упражнение 1** и начать лабораторную работу с **Упражнения 2** с помощью службы Power BI ([https://app.powerbi.com](https://app.powerbi.com)) вместо Power BI Desktop.

1. Загрузите [problem-reports-data.pbix](06\Resources\problem-reports-data.pbix) и сохраните на своем компьютере.
2. Перейдите в [Power BI](https://app.powerbi.com/).
3. Щелкните **Раблочее пространство 311**.
4. Разверните **+ Создать** и выберите **Загрузить файл**.

![Снимок экрана со стрелкой, указывающей на кнопку +Создать, и другой стрелкой, указывающей на кнопку загрузки файла](05/media/image-6-29.png)

5. Выберите **Локальный файл**.
6. Найдите и выберите файл **report-data.pbix**, который вы скачали ранее.
7. После завершения загрузки данных выберите отчет **problem-reports-data**.
8. Щелкните **...**, затем выберите **Изменить**.

![Снимок экрана со стрелкой, указывающей на значок с многоточием для дополнительных параметров и выбранной кнопкой редактирования](05/media/image-6-30.png)

9. Теперь можно приступить к **Упражнению 2: Создание отчета Power BI** этой лабораторной работы.
